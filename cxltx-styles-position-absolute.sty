


% ==========================================================================================================
% Absolute Textpositioning
% ----------------------------------------------------------------------------------------------------------
% see http://www.tex.ac.uk/ctan/macros/latex/contrib/textpos/textpos.pdf
\ProvidesPackage{cxltx-styles-position-absolute}
\usepackage[absolute,overlay]{textpos}
\usepackage{calc}% http://ctan.org/pkg/calc
\usepackage{fp}% http://ctan.org/pkg/fp

% % Set Horizontal and vertical modules:
% \setlength{\TPHorizModule}{1mm}
% \setlength{\TPVertModule}{1mm}

% set origin for absolutely positioned `textblock`s
% (set to upper left corner of main printing area):
\textblockorigin{0mm}{0mm}

% Define strut dimensions:
\newdimen\PaStrutHeight
\newdimen\PaStrutWidth
\newdimen\PaStrutDepth
\PaStrutWidth=0mm
\PaStrutHeight=0mm
\PaStrutDepth=0mm

% Define text dimensions:
\newdimen\PaTextWidth

% Remove horizontal and vertical spacing from paragraphs; curiously, we have to use a negative value for
% `\parskip` (see http://http://tex.stackexchange.com/questions/167628):
\newcommand{\PaNoSpacing}{\setlength{\parskip}{-\baselineskip}\setlength{\parindent}{0pt}}

% Determine locally valid strut dimensions:
\newcommand{\PaGauge}[1]{%
  \settoheight{\PaStrutHeight}{#1}%
  \settodepth{\PaStrutDepth}{#1}%
  \FPeval{\PaHeightDepthRatio}{\number\PaStrutHeight/(\number\PaStrutHeight+\number\PaStrutDepth)}%
  }

% Run gauging macro once to set default values:
\newcommand{\PaGaugeSample}{\PaGauge{abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?ยง\$}}%
\PaGaugeSample%

% Define a strut with the desired dimensions:
\newcommand{\PaStrut}{{\color{blue}\vrule height\PaStrutHeight width\PaStrutWidth depth\PaStrutDepth}}

\newcommand{\PaLeft}[3]{{%
  \settowidth{\PaTextWidth}{#3{\PaStrut}}
  \begin{textblock*}{\PaTextWidth}[0,\PaHeightDepthRatio](#1,#2)%
    \PaNoSpacing%
    \flushleft% needed although it should be gratuitous
    #3%
    {\PaStrut}%
    \end{textblock*}%
  }}

\newcommand{\PaCenter}[3]{{%
  \settowidth{\PaTextWidth}{{\PaStrut}#3{\PaStrut}}
  \begin{textblock*}{\PaTextWidth}[0.5,\PaHeightDepthRatio](#1,#2)%
    \PaNoSpacing%
    \center%
    {\PaStrut}%
    #3%
    {\PaStrut}%
    \end{textblock*}%
  }}

\newcommand{\PaRight}[3]{{%
  \settowidth{\PaTextWidth}{{\PaStrut}#3}
  \begin{textblock*}{\PaTextWidth}[1,\PaHeightDepthRatio](#1,#2)%
    \PaNoSpacing%
    \flushright% needed although it should be gratuitous
    {\PaStrut}%
    #3%
    \end{textblock*}%
  }}

\newcommand{\PaShow}{%
  \TPshowboxestrue%
  \PaStrutWidth=0.5mm%
  }

\newcommand{\PaHide}{%
  \TPshowboxesfalse%
  \PaStrutWidth=0.1mm%
  }

\PaHide

% You may give a optional argument to the \Lenv{textblock}
% environment, specifying which point in the box
% is to be placed at the specified point:
% \begin{quote}
% \begin{raggedright}
% \cmd|\begin{textblock}{<hsize>}[<ho>,<vo>](<hpos>,<vpos>)|\\
% text...\\
% |\end{textblock}|
% \end{raggedright}
% \end{quote}
% The coordinates \meta{ho} and \meta{vo} are fractions of the
% width and height of the text box, respectively, and state that the
% box is to be placed so that the reference
% point (\meta{ho},\meta{vo}) within the box is to be placed at the point
% (\meta{hpos},\meta{vpos}) on the page.  The default specification is
% [0,0], the top left of the box: [0,1] would be the bottom left, and
% [0.5,0.5] the middle.
